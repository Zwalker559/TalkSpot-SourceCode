{
    "entities": {
        "user": {
            "title": "User",
            "description": "A user of the application",
            "type": "object",
            "properties": {
                "uid": {
                    "type": "string",
                    "description": "The user's unique ID"
                },
                "displayName": {
                    "type": "string",
                    "description": "The user's display name"
                },
                "email": {
                    "type": "string",
                    "description": "The user's email address"
                },
                "photoURL": {
                    "type": "string",
                    "description": "The URL of the user's profile picture. Can be a standard URL or a Base64 Data URI."
                },
                "textingId": {
                    "type": "string",
                    "description": "The user's unique texting ID in xxxx-xxxx format."
                },
                "role": {
                    "type": "string",
                    "description": "The user's role, e.g., User, Sub-Manager, Lead-Manager, Co-Owner, Owner",
                    "enum": ["User", "Sub-Manager", "Lead-Manager", "Co-Owner", "Owner"]
                },
                "status": {
                    "type": "string",
                    "description": "The user's account status",
                    "enum": ["Active", "Suspended"]
                },
                 "suspensionReason": {
                    "type": "string",
                    "description": "The reason provided for an account suspension."
                },
                "visibility": {
                    "type": "string",
                    "description": "The user's profile visibility in search.",
                    "enum": ["public", "private"]
                },
                "chatFilters": {
                    "type": "object",
                    "description": "User preferences for chat content filtration.",
                    "properties": {
                        "blockLinks": {
                            "type": "boolean",
                            "description": "If true, hides messages containing URLs."
                        },
                        "blockProfanity": {
                            "type": "boolean",
                            "description": "If true, hides messages containing profanity."
                        }
                    }
                },
                "personalization": {
                    "type": "object",
                    "description": "User preferences for app personalization.",
                    "properties": {
                        "theme": {
                            "type": "string",
                            "description": "The selected UI theme."
                        },
                        "language": {
                            "type": "string",
                            "description": "The selected language."
                        }
                    }
                }
            },
            "required": [
                "uid",
                "displayName",
                "email",
                "textingId",
                "visibility"
            ]
        },
        "promotion": {
            "title": "Promotion",
            "description": "An advertisement or promotion to be displayed in the app.",
            "type": "object",
            "properties": {
                "title": {
                    "type": "string",
                    "description": "The title of the promotion."
                },
                "type": {
                    "type": "string",
                    "enum": ["text", "image"],
                    "description": "The type of promotion."
                },
                "content": {
                    "type": "string",
                    "description": "The ad text or a URL/Data URI to the ad image."
                },
                "logoUrl": {
                    "type": "string",
                    "description": "A URL/Data URI to a small logo for text-based ads."
                },
                 "actionType": {
                    "type": "string",
                    "enum": ["url", "popup", "enlarge", "none"],
                    "description": "The action to perform when the promotion is clicked."
                },
                "location": {
                    "type": "string",
                    "enum": ["header", "sidebar", "both"],
                    "description": "Where the promotion should be displayed."
                },
                "linkUrl": {
                    "type": "string",
                    "description": "The URL the promotion links to (if actionType is 'url')."
                },
                "popupContent": {
                    "type": "string",
                    "description": "The informational text to show in a pop-up (if actionType is 'popup')."
                },
                "status": {
                    "type": "string",
                    "enum": ["active", "disabled"],
                    "description": "The current status of the promotion."
                },
                "displayWeight": {
                    "type": "number",
                    "description": "A number representing the chance of this promotion being displayed. Higher is more likely."
                },
                "imageFit": {
                    "type": "string",
                    "enum": ["cover", "contain"],
                    "description": "How the ad image should be resized to fit its container. 'cover' will fill the space and crop, 'contain' will show the full image with possible letterboxing."
                },
                "createdAt": {
                    "$ref": "#/entities/timestamp",
                    "description": "Timestamp of when the promotion was created."
                }
            },
            "required": ["title", "type", "content", "actionType", "location", "status", "displayWeight"]
        },
        "chatRequest": {
            "title": "Chat Request",
            "description": "A request from one user to start a chat with another.",
            "type": "object",
            "properties": {
                "from": {
                    "type": "string",
                    "description": "UID of the user sending the request."
                },
                "to": {
                    "type": "string",
                    "description": "UID of the user receiving the request."
                },
                "status": {
                    "type": "string",
                    "enum": ["pending", "accepted", "denied"],
                    "description": "The current status of the request."
                }
            },
            "required": ["from", "to", "status"]
        },
        "conversation": {
            "title": "Conversation",
            "description": "Represents a chat session between two or more users.",
            "type": "object",
            "properties": {
                "participants": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "Array of UIDs of the users in the conversation."
                },
                "participantDetails": {
                    "type": "object",
                    "description": "Map of participant UIDs to their details like name and photo."
                },
                "lastMessage": {
                    "type": "string",
                    "description": "The text of the last message sent."
                },
                "lastMessageTimestamp": {
                    "$ref": "#/entities/timestamp",
                    "description": "Timestamp of the last message."
                },
                "lastMessageSenderId": {
                    "type": "string",
                    "description": "UID of the last message sender."
                }
            },
            "required": ["participants", "participantDetails"]
        },
        "message": {
            "title": "Message",
            "description": "A single message within a conversation.",
            "type": "object",
            "properties": {
                "senderId": {
                    "type": "string",
                    "description": "UID of the message sender."
                },
                "text": {
                    "type": "string",
                    "description": "The content of the message."
                },
                "timestamp": {
                    "$ref": "#/entities/timestamp",
                    "description": "When the message was sent."
                },
                "mediaUrl": {
                    "type": "string",
                    "description": "URL of any media attached to the message."
                }
            },
            "required": ["senderId", "text", "timestamp"]
        },
        "passwordRecovery": {
            "title": "Password Recovery",
            "description": "Stores user data needed for password recovery.",
            "type": "object",
            "properties": {
                "uid": { "type": "string" },
                "email": { "type": "string" },
                "securityQuestion": { "type": "string" },
                "securityAnswer": { "type": "string" },
                "isCaseSensitive": { "type": "boolean" }
            },
            "required": ["uid", "email"]
        },
        "auditLog": {
            "title": "Audit Log",
            "description": "Records administrative actions taken by staff.",
            "type": "object",
            "properties": {
                "actorUid": {
                    "type": "string",
                    "description": "UID of the staff member who performed the action."
                },
                "actorDisplayName": {
                    "type": "string",
                    "description": "Display name of the staff member."
                },
                "action": {
                    "type": "string",
                    "enum": [
                        "user.create",
                        "user.edit.display_name",
                        "user.edit.display_name_self",
                        "user.edit.texting_id",
                        "user.edit.role",
                        "user.edit.status.suspended",
                        "user.edit.status.activated",
                        "user.edit.password_reset",
                        "user.delete",
                        "promotion.create",
                        "promotion.edit",
                        "promotion.delete",
                        "audit.clear",
                        "notice.send",
                        "notice.clear"
                    ],
                    "description": "The type of action performed."
                },
                "timestamp": {
                    "$ref": "#/entities/timestamp",
                    "description": "When the action occurred."
                },
                "targetInfo": {
                    "type": "object",
                    "description": "Information about the entity that was acted upon.",
                    "properties": {
                        "type": {"type": "string", "enum": ["user", "promotion", "system"]},
                        "uid": {"type": "string"},
                        "displayName": {"type": "string"}
                    }
                },
                "details": {
                    "type": "object",
                    "description": "A map of specific changes made during the action."
                }
            },
            "required": ["actorUid", "actorDisplayName", "action", "timestamp"]
        },
        "globalNotice": {
            "title": "Global Notice",
            "description": "A sitewide announcement banner.",
            "type": "object",
            "properties": {
                "message": { "type": "string" },
                "active": { "type": "boolean" },
                "updatedAt": { "$ref": "#/entities/timestamp" },
                "updatedBy": { "type": "string" }
            },
            "required": ["message", "active"]
        },
        "timestamp": {
            "title": "Timestamp",
            "description": "A server-generated timestamp.",
            "type": "object",
            "properties": {
                "seconds": { "type": "number" },
                "nanoseconds": { "type": "number" }
            }
        }
    },
    "auth": {
        "providers": [
            "email",
            "anonymous",
            "google.com"
        ]
    },
    "firestore": {
        "/users/{userId}": {
            "schema": {
                "$ref": "#/entities/user"
            },
            "description": "User profile information"
        },
        "/user_lookups/{userId}": {
            "schema": {
                "type": "object",
                "properties": {
                    "uid": {"type": "string"},
                    "displayName": {"type": "string"},
                    "textingId": {"type": "string"},
                    "visibility": {"type": "string", "enum": ["public", "private"]}
                }
            },
            "description": "A public collection for looking up users by displayName or textingId."
        },
        "/password_recovery/{userId}": {
            "schema": {
                "$ref": "#/entities/passwordRecovery"
            },
            "description": "Secure information for account recovery."
        },
        "/requests/{requestId}": {
            "schema": {
                "$ref": "#/entities/chatRequest"
            },
            "description": "Chat requests between users."
        },
        "/conversations/{conversationId}": {
            "schema": {
                "$ref": "#/entities/conversation"
            },
            "description": "Metadata for a chat conversation."
        },
        "/conversations/{conversationId}/messages/{messageId}": {
            "schema": {
                "$ref": "#/entities/message"
            },
            "description": "All messages within a specific conversation."
        },
        "/Sponsorships/{sponsorshipId}": {
            "schema": {
                "$ref": "#/entities/promotion"
            },
            "description": "Stores all sponsor promotions and advertisements."
        },
        "/audit_logs/{logId}": {
            "schema": {
                "$ref": "#/entities/auditLog"
            },
            "description": "Stores records of administrative actions."
        },
        "/site_config/global_notice": {
            "schema": {
                "$ref": "#/entities/globalNotice"
            },
            "description": "Stores the current global notice for the site."
        }
    }
}